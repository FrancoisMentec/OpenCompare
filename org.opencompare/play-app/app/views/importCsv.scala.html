@header = {
    <link rel='stylesheet' href='@routes.Assets.at("stylesheets/importer.css")'>
}

@footer = {
    <script type="application/javascript">
        var fileInput = function ($parse) {
            return {
                restrict: "EA",
                template: "<input type='file' />",
                replace: true,
                link: function (scope, element, attrs) {

                    var modelGet = $parse(attrs.fileInput);
                    var modelSet = modelGet.assign;
                    var onChange = $parse(attrs.onChange);

                    var updateModel = function () {
                        scope.$apply(function () {
                            modelSet(scope, element[0].files[0]);
                            onChange(scope);
                        });
                    };

                    element.bind('change', updateModel);
                }
            };
        };
    </script>
    <script type='text/javascript' src='@routes.Assets.at("javascripts/kmf/pcm.min.js")'></script>
    <script type='text/javascript' src='@routes.Assets.at("javascripts/pcm-api.js")'></script>
    <script type='text/javascript' src='@routes.Assets.at("javascripts/controllers/pcm-importer-controller.js")'></script>
}

@toolbar = {}

@main(header, footer, toolbar) {

    <div id="importer" class="row" ng-controller="PCMImporterController">
        <form name="importPcm" id="import_pcm" class="form-horizontal" method="post" action="/api/convert/csv" enctype="multipart/form-data">
            <div class="row-fluid">
                <div class="col-md-12">

                    <div class="form-group">
                        <label class="col-md-4 control-label">@Messages("importer.select")</label>
                        <div class="col-md-8">
                            <input type="file" id="fileContent" name="fileContent" required/>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-md-4 control-label">@Messages("importer.pcm.title")</label>
                        <div class="col-md-8">
                            <input ng-model="config.title" type="string" id="title" name="title" size="80%" required/>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-md-4 control-label">@Messages("importer.pcm.productAsLines")</label>
                        <div class="col-md-8">
                            <input ng-model="config.productAsLines" type="checkbox" id="productAsLines" name="productAsLines" size="3"/>
                        </div>
                    </div>
                </div>
                <div class="col-md-12">
                    <div>
                        <div class="row">
                            <div class="col-md-3"></div>
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label class="col-md-2 control-label">@Messages("importer.csv.separator")</label>
                                    <div class="col-md-1">
                                        <input ng-model="config.separator" type="string" id="separator" name="separator" size="3" required/>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label class="col-md-2 control-label">@Messages("importer.csv.quote")</label>
                                    <div class="col-md-1">
                                        <input ng-model="config.quote" type="string" id="quote" name="quote" size="3"/>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3"></div>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <button type="submit" class="btn btn-success center-block" form="import_pcm"><i class="fa fa-valid"></i> @Messages("importer.button.confirm")</button>
                </div>
            </div>
        </form>

    </div>
}

