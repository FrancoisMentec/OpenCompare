@(id : String = null, data : play.api.libs.json.JsValue = null, modal : String = null)

@header = {
    <link rel='stylesheet' href='@routes.Assets.at("stylesheets/editor.css")'>
}

@footer = {
    @if(id != null) {
        <script>
            var id = "@{Html(id)}";
        </script>
    }
    @if(data != null) {
        <script>
            var data = '@{Html(data.toString().replace("'","\\\'"))}';
        </script>
    }
    @if(modal != null) {
        <script>
            var modal = '@{Html(modal)}';
            var modalTemplatePath = '@routes.Assets.at("templates/modal" + modal + ".html")';
        </script>
    }
    <script type='text/javascript' src='@routes.Assets.at("javascripts/kmf/pcm.min.js")'></script>
    <script type='text/javascript' src='@routes.Assets.at("javascripts/pcm-api.js")'></script>
    <script type='text/javascript' src='@routes.Assets.at("javascripts/controllers/pcm-editor-toolbar-controller.js")'></script>
    <script type='text/javascript' src='@routes.Assets.at("javascripts/controllers/pcm-editor-controller.js")'></script>
    <script type='text/javascript' src='@routes.Assets.at("javascripts/controllers/pcm-importer-controller.js")'></script>
}

@toolbar = {
    <nav class="navbar" ng-show="edit" role="navigation" ng-controller="PCMEditorToolbarController">
        <div class="container-fluid" >
            <div class="editor-toolbar">
                <button ng-show="!saved" role="button" class="btn btn-default" data-toggle="modal" data-target="#modalCancel"><i class="fa fa-undo"></i> Cancel</button>
                <button ng-show="saved" role="button" class="btn btn-default" ng-click="setEdit(false, true)"><i class="fa fa-undo"></i> Cancel</button>
                <button role="button" class="btn btn-default" ng-class='{"btn btn-default": !saved, "btn btn-success": saved && isTitleSet}' ng-disabled="!isTitleSet" ng-click="save()"><i class="fa" ng-class='{"fa-save": !saved, "fa-check": saved && isTitleSet}'></i> Save</button>
                <button role="button" class="btn btn-default" ng-class='{"btn btn-warning": validating, "btn btn-default": !validating}' ng-click="validate()"><i class="fa" ng-class='{"fa-search": !validating, "fa-times": validating}'></i> Validate</button>
                <button ng-show="isInDatabase" type="button" class="btn btn-danger" data-toggle="modal" data-target="#modalRemove"><i class="fa fa-trash"></i> Remove</button>
                <div class="btn-group">
                    <button class="btn dropdown-toggle" data-toggle="dropdown"><i class="fa fa-download"></i> @Messages("navbar.export") <span class="caret"></span></button>
                    <ul class="dropdown-menu">
                        <li><a href="#" ng-click="export('csv')" data-toggle="modal" data-target="#modalExport">@Messages("navbar.export.csv")</a></li>
                        <li><a href="#" ng-click="export('wikitext')" data-toggle="modal" data-target="#modalExport">@Messages("navbar.export.wikipedia")</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </nav>
}

@main(header, footer, toolbar) {
<div>
    <div open-compare-editor ng-controller="PCMEditorController">
    </div>
</div>
}